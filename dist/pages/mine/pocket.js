(wx.webpackJsonp=wx.webpackJsonp||[]).push([[46],{"139":function(t,e,a){t.exports=a.p+"pages/mine/pocket.wxml"},"207":function(t,e,a){"use strict";a.r(e);a(208);var o=a(78);for(var n in o)"default"!==n&&function(t){a.d(e,t,function(){return o[t]})}(n)},"208":function(t,e,a){"use strict";a(139)},"209":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{"value":!0}),e.setPassword=e.startWithdraw=e.withdrawHistory=e.walletFlow=e.getWalletInfo=void 0;var o=_interopRequireDefault(a(4));function _interopRequireDefault(t){return t&&t.__esModule?t:{"default":t}}var n=_interopRequireDefault(a(0)).default.getStorageSync("userId");e.getWalletInfo=function getWalletInfo(){return o.default.get("/api/v1/user/account/wallet/info?userId="+n)},e.walletFlow=function walletFlow(t){return o.default.get("/api/v1/user/account/wallet/log?userId="+n,t)},e.withdrawHistory=function withdrawHistory(t){return o.default.get("/api/v1/user/withdraw/findUserWithdrawListPage?userId="+n,t)},e.startWithdraw=function startWithdraw(t){return o.default.post("/api/v1/user/withdraw/buildWithdrawOrder?userId="+n,t)},e.setPassword=function setPassword(t){return o.default.post("/api/v1/user/account/setPayPwd?userId="+n+"&payPwd="+t)}},"21":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{"value":!0});var R=function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function sliceIterator(t,e){var a=[],o=!0,n=!1,i=void 0;try{for(var r,s=t[Symbol.iterator]();!(o=(r=s.next()).done)&&(a.push(r.value),!e||a.length!==e);o=!0);}catch(t){n=!0,i=t}finally{try{!o&&s.return&&s.return()}finally{if(n)throw i}}return a}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")},o=function(t,e,a){return e&&defineProperties(t.prototype,e),a&&defineProperties(t,a),t};function defineProperties(t,e){for(var a=0;a<e.length;a++){var o=e[a];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}var n,i,A=a(0),r=function _interopRequireDefault(t){return t&&t.__esModule?t:{"default":t}}(A),s=a(209);function _possibleConstructorReturn(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}a(210);var d=(function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{"constructor":{"value":t,"enumerable":!1,"writable":!0,"configurable":!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(Mine,A.Component),o(Mine,[{"key":"_constructor","value":function _constructor(){(function get(t,e,a){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,e);if(void 0===o){var n=Object.getPrototypeOf(t);return null===n?void 0:get(n,e,a)}if("value"in o)return o.value;var i=o.get;return void 0!==i?i.call(a):void 0})(Mine.prototype.__proto__||Object.getPrototypeOf(Mine.prototype),"_constructor",this).apply(this,arguments),this.state={"withdrawMoney":"","withdrawPwdForm":"","withdrawPwd":"","showModal":!1,"showModalPwd":!1,"wallet":{"money":0,"frozenAmount":0,"isSetPayPwd":"N"},"pageSize":10,"pageNo":1,"current":0,"hasNextPage":!0,"hasNextPageWith":!0,"pageSizeWith":10,"pageNoWith":1,"flowLists":[],"withdrawLists":[]},this.$$refs=new r.default.RefsArray}},{"key":"onPullDownRefresh","value":function onPullDownRefresh(){this.refreshPage()}},{"key":"onReachBottom","value":function onReachBottom(){this.scrollToBottom()}},{"key":"componentWillMount","value":function componentWillMount(){this.getInfo(),this.getFlow(),this.getWithDrawHistory()}},{"key":"_createData","value":function _createData(t,e,a){var o=this;this.__state=t||this.state||{},this.__props=e||this.props||{};var n=this.$prefix,i=(0,A.genCompid)(n+"$compid__78"),r=R(i,2),s=r[0],d=r[1],u=(0,A.genCompid)(n+"$compid__79"),l=R(u,2),c=l[0],h=l[1],w=(0,A.genCompid)(n+"$compid__80"),p=R(w,2),f=p[0],g=p[1],_=(0,A.genCompid)(n+"$compid__81"),m=R(_,2),y=m[0],P=m[1],v=(0,A.genCompid)(n+"$compid__82"),M=R(v,2),b=M[0],W=M[1],S=(0,A.genCompid)(n+"$compid__83"),F=R(S,2),N=F[0],$=F[1],C=(0,A.genCompid)(n+"$compid__84"),x=R(C,2),O=x[0],T=x[1],k=(0,A.genCompid)(n+"$compid__85"),I=R(k,2),L=I[0],j=I[1],D=[{"title":"流水记录"},{"title":"提现记录"}];return this.anonymousFunc0=function(){o.toggleModalStatus("pwd")},this.anonymousFunc1=function(t){return o.handleWithdrawChange(t,"withdrawMoney")},this.anonymousFunc2=function(t){return o.handleWithdrawChange(t,"withdrawPwdForm")},this.anonymousFunc3=function(){o.toggleModalStatus("widthdraw")},A.propsManager.set({"current":this.__state.current,"tabList":D,"onClick":this.handleTabClick},d,s),A.propsManager.set({"current":this.__state.current,"index":0},h,c),A.propsManager.set({"current":this.__state.current,"index":1},g,f),A.propsManager.set({"closeOnClickOverlay":!1,"className":"pwd-modal","isOpened":this.__state.showModalPwd},P,y),A.propsManager.set({"name":"withdrawPwd","type":"password","placeholder":"请设置提现密码,最少6位","value":this.__state.withdrawPwd,"onChange":this.handleWithdrawPwdChange},W,b),A.propsManager.set({"className":"withdraw-modal","isOpened":this.__state.showModal},$,N),A.propsManager.set({"name":"withdrawMoney","title":"金额","type":"number","placeholder":"请输入金额","value":this.__state.withdrawMoney,"onChange":this.anonymousFunc1},T,O),A.propsManager.set({"name":"withdrawMoney","title":"提现密码","type":"password","placeholder":"提现密码,忘记请打客服","value":this.__state.withdrawPwdForm,"onChange":this.anonymousFunc2},j,L),Object.assign(this.__state,{"anonymousState__temp":D,"$compid__78":d,"$compid__79":h,"$compid__80":g,"$compid__81":P,"$compid__82":W,"$compid__83":$,"$compid__84":T,"$compid__85":j}),this.__state}},{"key":"anonymousFunc0","value":function anonymousFunc0(){}},{"key":"anonymousFunc1","value":function anonymousFunc1(){}},{"key":"anonymousFunc2","value":function anonymousFunc2(){}},{"key":"anonymousFunc3","value":function anonymousFunc3(){}}]),i=n=Mine,n.$$events=["handleWithdrawBtn","anonymousFunc0","handlePwd","anonymousFunc3","handleWithdraw"],n.$$componentPath="pages/mine/pocket",i);function Mine(){var t,e,a;!function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,Mine);for(var o=arguments.length,n=Array(o),i=0;i<o;i++)n[i]=arguments[i];return(e=a=_possibleConstructorReturn(this,(t=Mine.__proto__||Object.getPrototypeOf(Mine)).call.apply(t,[this].concat(n)))).$usedState=["anonymousState__temp","$compid__78","$compid__79","$compid__80","$compid__81","$compid__82","$compid__83","$compid__84","$compid__85","withdrawMoney","withdrawPwdForm","withdrawPwd","showModal","showModalPwd","wallet","pageSize","pageNo","current","hasNextPage","hasNextPageWith","pageSizeWith","pageNoWith","flowLists","withdrawLists"],a.config={"navigationBarTitleText":"我的钱包","navigationStyle":"default"},a.getInfo=function(){r.default.showLoading({"title":"加载中"}),(0,s.getWalletInfo)().then(function(t){if(r.default.hideLoading(),r.default.stopPullDownRefresh(),0===t.data.code){var e=t.data.data;a.setState({"wallet":e})}})},a.getFlow=function(){if(a.state.hasNextPage){var t={"pageNo":a.state.pageNo,"pageSize":a.state.pageSize};r.default.showToast({"title":"加载中","icon":"none"}),(0,s.walletFlow)(t).then(function(t){if(r.default.hideToast(),0===t.data.code){var e=t.data.data;a.setState(function(t){return{"hasNextPage":e.hasNextPage,"pageNo":e.hasNextPage?e.nextPage:e.pageNo,"flowLists":t.flowLists.concat(e.list)}})}})}else r.default.showToast({"title":"没有更多了~","icon":"none"})},a.getWithDrawHistory=function(){if(a.state.hasNextPageWith){var t={"pageNo":a.state.pageNoWith,"pageSize":a.state.pageSizeWith};r.default.showToast({"title":"加载中","icon":"none"}),(0,s.withdrawHistory)(t).then(function(t){if(r.default.hideLoading(),0===t.data.code){var e=t.data.data;a.setState(function(t){return{"hasNextPageWith":e.hasNextPage,"pageNoWith":e.hasNextPage?e.nextPage:e.pageNo,"withdrawLists":t.withdrawLists.concat(e.list)}})}})}else r.default.showToast({"title":"没有更多了~","icon":"none"})},a.toggleModalStatus=function(t){"pwd"===t?a.setState({"showModalPwd":!1,"withdrawPwd":""}):"widthdraw"===t&&a.setState({"showModal":!1,"withdrawMoney":"","withdrawPwdForm":""})},a.scrollToBottom=function(){0===a.state.current?a.getFlow():a.getWithDrawHistory()},a.handleWithdrawBtn=function(){"N"===a.state.wallet.isSetPayPwd?a.setState({"showModalPwd":!0}):a.setState({"showModal":!0})},a.refreshPage=function(){a.setState({"pageSize":10,"pageNo":1,"current":0,"hasNextPage":!0,"hasNextPageWith":!0,"pageSizeWith":10,"pageNoWith":1,"flowLists":[],"withdrawLists":[],"showModalPwd":!1,"withdrawPwd":"","showModal":!1,"withdrawMoney":"","withdrawPwdForm":""},function(){a.getInfo(),a.getFlow(),a.getWithDrawHistory()})},a.handleWithdrawChange=function(t,e){a.setState(function _defineProperty(t,e,a){return e in t?Object.defineProperty(t,e,{"value":a,"enumerable":!0,"configurable":!0,"writable":!0}):t[e]=a,t}({},e,t))},a.handleWithdraw=function(){var t={"amount":a.state.withdrawMoney,"payPwd":a.state.withdrawPwdForm};r.default.showToast({"title":"提交中","icon":"none"}),(0,s.startWithdraw)(t).then(function(t){r.default.hideToast(),0===t.data.code?(r.default.showToast({"title":"操作成功","icon":"none"}),a.refreshPage()):r.default.showToast({"title":"操作失败:"+t.data.msg,"icon":"none"})})},a.handleTabClick=function(t){a.setState({"current":t,"showModalPwd":!1})},a.handleWithdrawPwdChange=function(t){a.setState({"withdrawPwd":t})},a.handlePwd=function(){var t=a.state.withdrawPwd;t.length<6?r.default.showToast({"title":"密码至少6数字","icon":"none"}):(0,s.setPassword)(t).then(function(t){0===t.data.code?(r.default.showToast({"title":"设置成功","icon":"none"}),a.toggleModalStatus("pwd"),a.setState({"showModal":!0})):r.default.showToast({"title":"设置失败："+t.data.msg,"icon":"none"})})},a.customComponents=["AtTabs","AtTabsPane","AtModal","AtModalHeader","AtModalContent","AtInput","AtModalAction"],_possibleConstructorReturn(a,e)}e.default=d,Component(a(0).default.createComponent(d,!0))},"210":function(t,e,a){},"78":function(t,e,a){"use strict";a.r(e);var o=a(21),n=a.n(o);for(var i in o)"default"!==i&&function(t){a.d(e,t,function(){return o[t]})}(i);e.default=n.a}},[[207,0,1,2]]]);