(wx.webpackJsonp=wx.webpackJsonp||[]).push([[52],{"161":function(t,e,o){t.exports=o.p+"pages/staff-order/pay.wxml"},"253":function(t,e,o){"use strict";o.r(e);o(254);var n=o(97);for(var a in n)"default"!==a&&function(t){o.d(e,t,function(){return n[t]})}(a)},"254":function(t,e,o){"use strict";o(161)},"255":function(t,e,o){},"256":function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAD6klEQVRoQ+2Za+hlUxjGf88X4YP7yGX4pBAxUmQSplxjFDVlpCEjhpJohuGL0aTk8kVMjEiZyRQycomQ+UJjMmpEZvJlzLiUW0rk2qO39v+055y9z1rr/PfpGJ23dvv03+963udZl3e9a/3FXm7ay/kzFTDpEZyOwP9mBGzPBc4FTgYOqj1/Ad8C39TemyX90IX4WU0h22cDVwLzgTMLCb0FvAS8LWlnYdue+0gCbF8NxHPpqIH72r0CPCTp/VK8IgG2TwceAM4vDZTp/2AlJHt6ZQuwfWNF/uBMMqO67QBWS1qfA5AlwPa9wKocwA59Vkm6L4WXFDAh8jO810q6aZiIoQImTP4X4OV4JG1sE9EqwPZlwKupIRzD9+0V8Y2StqTwGwXYPjLyM3BSCqDD7+/WiH89g2v7CuBu4GJJP/XHaxPwKHBrh+TaoP4BItsMTBPb84B7gEVV4+WSHskV8AVw3BgF7KqID0wT24cAdwF39sX/HJgn6c/63wdGwHaUBJsT5KOuOWoEgYG7DgjivWlSmy7Lql4/pgV7maQnUwKSOV+SbN8A3A8cniEkap51bdnE9iXASuCcBNYTkm5OCXgeuCoBtETSc7aj8gwRlzf4/1hNk/Vt2cR2JIkVwLUZnRAub0oKsT1rmkIfA6clAHdIOqE29LHYQkjYJzXiA9MkHGwfANxeTZd9MsmH23ZJJ6YE/ArsnwG6SNKLNRGHxVlA0qZhbW1fXy3Q4zNi9Lv8Lmm/lICvgKMzwLdJilSXZbajgl0OXJTVoNlpt6RjUwLeA87LDLJQ0muJHo+evgOIana2FoefC1MCngIiw+RYHA3PanK0HUMdxGORHpgDluHzmKQ9NtimRXwL8HgG2IzLBZLeqfvbXlKRP7UAJ8d1saQNqRGYA3yXg1b5bJK0IH7bjqkXvb6woH2u62/AHEnx7llbLRRn1Kbc3hbshQAvWDu5pOt+GyQt7m/YJiA2lmdHiTLGNguaUvSw88AaYI9te4zkUtCtx8vUiSx20lGKthShku+9NdbUKCUgNo0vS6J17BsnsmskRXnfaDmH+qiLPgD27ZhcCu4N4DpJ3w9zTAqo0uMRQGSmM1JRO/oe6+82SX+n8LIEzIDY/giI27lxWfT2SknP5AYoFRA7dOzU47C1wBpJ20rASwXsBuIavUsL4nGBtXUU0GwBtk8B+nvnaSCuyWPo438DUUq0VbI/A3GN/hnwYfX+VFJJ2TKgsURAVKhRqYbFoeVhSa839Vp1sxC3C4cCfwRxSSGgcysREIf9pRXxuDf6T1i2gGAbPdt0OzZJJUUCJkm0LfZUwKRHZToC0xGYZQ/8C9MWOkBDBT4nAAAAAElFTkSuQmCC"},"38":function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{"value":!0});var o=function(t,e,o){return e&&defineProperties(t.prototype,e),o&&defineProperties(t,o),t};function defineProperties(t,e){for(var o=0;o<e.length;o++){var n=e[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var n,a,i=r(6),s=r(0),u=function _interopRequireDefault(t){return t&&t.__esModule?t:{"default":t}}(s),l=r(9),f=r(5);function _possibleConstructorReturn(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}r(255);var p=(function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{"constructor":{"value":t,"enumerable":!1,"writable":!0,"configurable":!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(Quote,s.Component),o(Quote,[{"key":"_constructor","value":function _constructor(t){(function get(t,e,o){null===t&&(t=Function.prototype);var n=Object.getOwnPropertyDescriptor(t,e);if(void 0===n){var a=Object.getPrototypeOf(t);return null===a?void 0:get(a,e,o)}if("value"in n)return n.value;var r=n.get;return void 0!==r?r.call(o):void 0})(Quote.prototype.__proto__||Object.getPrototypeOf(Quote.prototype),"_constructor",this).call(this,t),this.state={"staffPrice":0,"id":"","qrContent":"","payInfo":[],"totalAmount":0,"detailLists":[],"paySn":"","payRes":"N","timer":null,"timeOutTimer":null,"type":"","bookOrderDetail":null},this.$$refs=new u.default.RefsArray}},{"key":"componentWillUnmount","value":function componentWillUnmount(){clearTimeout(this.state.timeOutTimer),clearInterval(this.state.timer)}},{"key":"componentWillMount","value":function componentWillMount(){var t=this,e=this.$router.params,o=e.id,n=e.type;this.setState({"id":o,"type":n},function(){"staff"===n?(t.getPayInfo(o),t.getPayDetail(o)):(t.getPayInfo(o),t.getBookInfo())})}},{"key":"_createData","value":function _createData(t,e,o){this.__state=t||this.state||{},this.__props=e||this.props||{},this.$prefix;var n=r(256),a="staff"===this.__state.type?this.__state.detailLists.map(function(t,e){return(t={"$original":(0,s.internal_get_original)(t)}).$original.isPay,{"$original":t.$original}}):[];return Object.assign(this.__state,{"anonymousState__temp":n,"loopArray56":a}),this.__state}}]),a=n=Quote,n.$$events=[],n.$$componentPath="pages/staff-order/pay",a);function Quote(){var t,e,n;!function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,Quote);for(var o=arguments.length,a=Array(o),r=0;r<o;r++)a[r]=arguments[r];return(e=n=_possibleConstructorReturn(this,(t=Quote.__proto__||Object.getPrototypeOf(Quote)).call.apply(t,[this].concat(a)))).$usedState=["anonymousState__temp","loopArray56","staffPrice","id","qrContent","payInfo","totalAmount","detailLists","paySn","payRes","timer","timeOutTimer","type","bookOrderDetail","appStore"],n.config={"navigationBarTitleText":"收款","navigationStyle":"default"},n.getBookInfo=function(){var t=n.props.appStore.bookOrderDetail;n.setState({"bookOrderDetail":t})},n.getPayInfo=function(t){var e={"orderIds":[t],"payBusinessType":"staff"===n.state.type?"W_REPAIR_ORDER":"BOOKING_ORDER","payCode":"WX_QR"};(0,l.QrPay)(e).then(function(t){if(0===t.data.code){var e=t.data.data;n.setState({"qrContent":e.qrContent,"paySn":e.paySn},function(){var t=setInterval(function(){n.getPayResult()},3e3),e=setTimeout(function(){clearTimeout(n.state.timeOutTimer),clearInterval(n.state.timer)},18e4);n.setState({"timer":t,"timeOutTimer":e})})}else u.default.showToast({"title":t.data.msg,"icon":"none"})})},n.getPayDetail=function(t){(0,l.orderDetail)(t).then(function(t){if(0===t.data.code){var e=t.data.data,o=0;e.repairOrderAmountVos.forEach(function(t){"ALL_AMOUNT"===t.type&&(o=t.amount)}),n.setState({"totalAmount":o,"payInfo":e.repairOrderAmountVos,"detailLists":e.repairOrderOfferPlanVoList})}else u.default.showToast({"title":t.data.msg,"icon":"none"})})},n.getPayResult=function(){(0,l.payRes)(n.state.paySn).then(function(t){0===t.data.code&&"Y"===t.data.data&&(console.log("支付成功--------"),clearInterval(n.state.timer),clearInterval(n.state.timeOutTimer),u.default.showToast({"title":"用户支付成功"}).then(function(){return setTimeout(function(){var t=n.state,e=t.id;"staff"===t.type?u.default.navigateTo({"url":"/pages/staff-order/detail?id="+e}):u.default.navigateTo({"url":"/pages/mall/order-lists-staff?from=pay"})},1e3)}))})},n.customComponents=[],_possibleConstructorReturn(n,e)}p=(0,i.__decorate)([(0,f.inject)("appStore"),f.observer],p),e.default=p,Component(r(0).default.createComponent(p,!0))},"97":function(t,e,o){"use strict";o.r(e);var n=o(38),a=o.n(n);for(var r in n)"default"!==r&&function(t){o.d(e,t,function(){return n[t]})}(r);e.default=a.a}},[[253,0,1,2]]]);